<?xml version="1.0" ?>
<testsuites disabled="0" errors="0" failures="24" tests="54" time="0.0">
	<testsuite disabled="0" errors="0" failures="24" name="cloudformation scan" skipped="0" tests="54" time="0">
		<properties>
			<property name="directory" value="['.']"/>
			<property name="add_check" value="False"/>
			<property name="list" value="False"/>
			<property name="output" value="['cli', 'junitxml']"/>
			<property name="output_file_path" value="console,checkov.xml"/>
			<property name="output_bc_ids" value="False"/>
			<property name="include_all_checkov_policies" value="True"/>
			<property name="quiet" value="True"/>
			<property name="compact" value="False"/>
			<property name="framework" value="['cloudformation']"/>
			<property name="skip_framework" value="[]"/>
			<property name="run_all_external_checks" value="False"/>
			<property name="soft_fail" value="False"/>
			<property name="skip_results_upload" value="False"/>
			<property name="repo_id" value="cli_repo/govuk-mobile-backend"/>
			<property name="branch" value="master"/>
			<property name="skip_download" value="False"/>
			<property name="use_enforcement_rules" value="False"/>
			<property name="external_modules_download_path" value=".external_modules"/>
			<property name="evaluate_variables" value="True"/>
			<property name="no_cert_verify" value="False"/>
			<property name="create_baseline" value="False"/>
			<property name="output_baseline_as_skipped" value="False"/>
			<property name="secrets_scan_file_type" value="[]"/>
			<property name="enable_secret_scan_all_files" value="False"/>
			<property name="block_list_secret_scan" value="[]"/>
			<property name="summary_position" value="top"/>
			<property name="skip_resources_without_violations" value="False"/>
			<property name="deep_analysis" value="False"/>
			<property name="no_fail_on_crash" value="False"/>
			<property name="mask" value="defaultdict(&lt;class 'set'&gt;, {})"/>
			<property name="scan_secrets_history" value="False"/>
			<property name="secrets_history_timeout" value="12h"/>
			<property name="custom_tool_name" value="Checkov"/>
		</properties>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="/auth/template.yaml.AWS::Logs::LogGroup.CognitoWAFLogGroup" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="/auth/template.yaml.AWS::Logs::LogGroup.CognitoWAFLogGroup" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_33] Ensure KMS key policy does not contain wildcard (*) principal" classname="/auth/template.yaml.AWS::KMS::Key.CognitoWAFLogGroupKMSKey" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_7] Ensure rotation for customer created CMKs is enabled" classname="/auth/template.yaml.AWS::KMS::Key.CognitoWAFLogGroupKMSKey" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_26] Ensure all data stored in the SNS topic is encrypted" classname="/auth/template.yaml.AWS::SNS::Topic.CloudWatchAlarmSignUpThrottlesTopicPagerDuty" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_26] Ensure all data stored in the SNS topic is encrypted" classname="/auth/template.yaml.AWS::SNS::Topic.CloudWatchAlarmSignInThrottlesTopicPagerDuty" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_26] Ensure all data stored in the SNS topic is encrypted" classname="/auth/template.yaml.AWS::SNS::Topic.CloudWatchAlarmTokenRefreshThrottlesTopicPagerDuty" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_26] Ensure all data stored in the SNS topic is encrypted" classname="/auth/template.yaml.AWS::SNS::Topic.CloudWatchAlarmFederationThrottlesTopicPagerDuty" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_33] Ensure KMS key policy does not contain wildcard (*) principal" classname="/auth/template.yaml.AWS::KMS::Key.CloudWatchAlarmNotificationTopicKey" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_7] Ensure rotation for customer created CMKs is enabled" classname="/auth/template.yaml.AWS::KMS::Key.CloudWatchAlarmNotificationTopicKey" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environment variable" classname="/auth/template.yaml.AWS::Serverless::Function.PagerDutyTestFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/auth/template.yaml.AWS::Serverless::Function.PagerDutyTestFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in Lambda environment" classname="/auth/template.yaml.AWS::Serverless::Function.PagerDutyTestFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="/auth/template.yaml.AWS::Lambda::Permission.PagerDutyTestFunctionCloudWatchAlarmSignUpThrottlesPermission" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="/auth/template.yaml.AWS::Lambda::Permission.PagerDutyTestFunctionCloudWatchAlarmSignInThrottlesPermission" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="/auth/template.yaml.AWS::Lambda::Permission.PagerDutyTestFunctionCloudWatchTokenRefreshThrottlesPermission" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="/auth/template.yaml.AWS::Lambda::Permission.PagerDutyTestFunctionCloudWatchFederationThrottlesPermission" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environment variable" classname="/auth/template.yaml.AWS::Serverless::Function.PostAuthenticationFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/auth/template.yaml.AWS::Serverless::Function.PostAuthenticationFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in Lambda environment" classname="/auth/template.yaml.AWS::Serverless::Function.PostAuthenticationFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environment variable" classname="/auth/template.yaml.AWS::Serverless::Function.TestFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/auth/template.yaml.AWS::Serverless::Function.TestFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in Lambda environment" classname="/auth/template.yaml.AWS::Serverless::Function.TestFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/auth/template.yaml.AWS::Serverless::Function.AuthProxyFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in Lambda environment" classname="/auth/template.yaml.AWS::Serverless::Function.AuthProxyFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="/auth/template.yaml.AWS::Lambda::Permission.LambdaInvokePermission" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="/auth/template.yaml.AWS::Lambda::Permission.PostAuthLambdaInvokePermission" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environment variable" classname="/auth/template.yaml.AWS::Serverless::Function.SignalsFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="/auth/template.yaml.AWS::Serverless::Function.SignalsFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in Lambda environment" classname="/auth/template.yaml.AWS::Serverless::Function.SignalsFunction" file="/auth/template.yaml"/>
		<testcase name="[NONE][CKV_AWS_192] Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell" classname="/auth/template.yaml.AWS::WAFv2::WebACL.CognitoWebApplicationFirewall" file="/auth/template.yaml">
			<failure type="failure" message="Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell">
Resource: AWS::WAFv2::WebACL.CognitoWebApplicationFirewall
File: /auth/template.yaml: 169-238
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-waf-prevents-message-lookup-in-log4j2

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/auth/template.yaml.AWS::Serverless::Function.PagerDutyTestFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: AWS::Serverless::Function.PagerDutyTestFunction
File: /auth/template.yaml: 707-724
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		707 |   PagerDutyTestFunction:
		708 |     Condition: IsNotProduction
		709 |     Type: AWS::Serverless::Function
		710 |     Properties:
		711 |       CodeUri: pager-duty-test-endpoint/
		712 |       Handler: app.lambdaHandler
		713 |       Tags:
		714 |         Product: GOV.UK
		715 |         Environment: !Ref Environment
		716 |         System: Authentication
		717 |     Metadata:
		718 |       BuildMethod: esbuild
		719 |       BuildProperties:
		720 |         Minify: true
		721 |         Target: "es2020"
		722 |         SourceMap: false
		723 |         EntryPoints:
		724 |           - app.ts
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/auth/template.yaml.AWS::Serverless::Function.PagerDutyTestFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: AWS::Serverless::Function.PagerDutyTestFunction
File: /auth/template.yaml: 707-724
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		707 |   PagerDutyTestFunction:
		708 |     Condition: IsNotProduction
		709 |     Type: AWS::Serverless::Function
		710 |     Properties:
		711 |       CodeUri: pager-duty-test-endpoint/
		712 |       Handler: app.lambdaHandler
		713 |       Tags:
		714 |         Product: GOV.UK
		715 |         Environment: !Ref Environment
		716 |         System: Authentication
		717 |     Metadata:
		718 |       BuildMethod: esbuild
		719 |       BuildProperties:
		720 |         Minify: true
		721 |         Target: "es2020"
		722 |         SourceMap: false
		723 |         EntryPoints:
		724 |           - app.ts
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/auth/template.yaml.AWS::Serverless::Function.PagerDutyTestFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: AWS::Serverless::Function.PagerDutyTestFunction
File: /auth/template.yaml: 707-724
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		707 |   PagerDutyTestFunction:
		708 |     Condition: IsNotProduction
		709 |     Type: AWS::Serverless::Function
		710 |     Properties:
		711 |       CodeUri: pager-duty-test-endpoint/
		712 |       Handler: app.lambdaHandler
		713 |       Tags:
		714 |         Product: GOV.UK
		715 |         Environment: !Ref Environment
		716 |         System: Authentication
		717 |     Metadata:
		718 |       BuildMethod: esbuild
		719 |       BuildProperties:
		720 |         Minify: true
		721 |         Target: "es2020"
		722 |         SourceMap: false
		723 |         EntryPoints:
		724 |           - app.ts
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_120] Ensure API Gateway caching is enabled" classname="/auth/template.yaml.AWS::Serverless::Api.ApiGateway" file="/auth/template.yaml">
			<failure type="failure" message="Ensure API Gateway caching is enabled">
Resource: AWS::Serverless::Api.ApiGateway
File: /auth/template.yaml: 762-782
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-api-gateway-caching-is-enabled

		762 |   ApiGateway:
		763 |     Type: AWS::Serverless::Api
		764 |     Properties:
		765 |       Name: !Join
		766 |         - "-"
		767 |         - - !Ref AWS::StackName
		768 |           - "api-gateway"
		769 |           - Fn::Select:
		770 |               - 4
		771 |               - Fn::Split:
		772 |                   - "-"
		773 |                   - Fn::Select:
		774 |                       - 2
		775 |                       - Fn::Split:
		776 |                           - "/"
		777 |                           - Ref: AWS::StackId
		778 |       StageName: !Ref Environment
		779 |       Tags:
		780 |         Product: GOV.UK
		781 |         Environment: !Ref Environment
		782 |         System: Authentication
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_73] Ensure API Gateway has X-Ray Tracing enabled" classname="/auth/template.yaml.AWS::Serverless::Api.ApiGateway" file="/auth/template.yaml">
			<failure type="failure" message="Ensure API Gateway has X-Ray Tracing enabled">
Resource: AWS::Serverless::Api.ApiGateway
File: /auth/template.yaml: 762-782
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-15

		762 |   ApiGateway:
		763 |     Type: AWS::Serverless::Api
		764 |     Properties:
		765 |       Name: !Join
		766 |         - "-"
		767 |         - - !Ref AWS::StackName
		768 |           - "api-gateway"
		769 |           - Fn::Select:
		770 |               - 4
		771 |               - Fn::Split:
		772 |                   - "-"
		773 |                   - Fn::Select:
		774 |                       - 2
		775 |                       - Fn::Split:
		776 |                           - "/"
		777 |                           - Ref: AWS::StackId
		778 |       StageName: !Ref Environment
		779 |       Tags:
		780 |         Product: GOV.UK
		781 |         Environment: !Ref Environment
		782 |         System: Authentication
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_76] Ensure API Gateway has Access Logging enabled" classname="/auth/template.yaml.AWS::Serverless::Api.ApiGateway" file="/auth/template.yaml">
			<failure type="failure" message="Ensure API Gateway has Access Logging enabled">
Resource: AWS::Serverless::Api.ApiGateway
File: /auth/template.yaml: 762-782
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-17

		762 |   ApiGateway:
		763 |     Type: AWS::Serverless::Api
		764 |     Properties:
		765 |       Name: !Join
		766 |         - "-"
		767 |         - - !Ref AWS::StackName
		768 |           - "api-gateway"
		769 |           - Fn::Select:
		770 |               - 4
		771 |               - Fn::Split:
		772 |                   - "-"
		773 |                   - Fn::Select:
		774 |                       - 2
		775 |                       - Fn::Split:
		776 |                           - "/"
		777 |                           - Ref: AWS::StackId
		778 |       StageName: !Ref Environment
		779 |       Tags:
		780 |         Product: GOV.UK
		781 |         Environment: !Ref Environment
		782 |         System: Authentication
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/auth/template.yaml.AWS::Serverless::Function.PostAuthenticationFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: AWS::Serverless::Function.PostAuthenticationFunction
File: /auth/template.yaml: 784-800
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		784 |   PostAuthenticationFunction:
		785 |     Type: AWS::Serverless::Function
		786 |     Properties:
		787 |       CodeUri: post-authentication-function/
		788 |       Handler: app.lambdaHandler
		789 |       Tags:
		790 |         Product: GOV.UK
		791 |         Environment: !Ref Environment
		792 |         System: Authentication
		793 |     Metadata:
		794 |       BuildMethod: esbuild
		795 |       BuildProperties:
		796 |         Minify: true
		797 |         Target: "es2020"
		798 |         SourceMap: false
		799 |         EntryPoints:
		800 |           - app.ts
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/auth/template.yaml.AWS::Serverless::Function.PostAuthenticationFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: AWS::Serverless::Function.PostAuthenticationFunction
File: /auth/template.yaml: 784-800
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		784 |   PostAuthenticationFunction:
		785 |     Type: AWS::Serverless::Function
		786 |     Properties:
		787 |       CodeUri: post-authentication-function/
		788 |       Handler: app.lambdaHandler
		789 |       Tags:
		790 |         Product: GOV.UK
		791 |         Environment: !Ref Environment
		792 |         System: Authentication
		793 |     Metadata:
		794 |       BuildMethod: esbuild
		795 |       BuildProperties:
		796 |         Minify: true
		797 |         Target: "es2020"
		798 |         SourceMap: false
		799 |         EntryPoints:
		800 |           - app.ts
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/auth/template.yaml.AWS::Serverless::Function.PostAuthenticationFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: AWS::Serverless::Function.PostAuthenticationFunction
File: /auth/template.yaml: 784-800
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		784 |   PostAuthenticationFunction:
		785 |     Type: AWS::Serverless::Function
		786 |     Properties:
		787 |       CodeUri: post-authentication-function/
		788 |       Handler: app.lambdaHandler
		789 |       Tags:
		790 |         Product: GOV.UK
		791 |         Environment: !Ref Environment
		792 |         System: Authentication
		793 |     Metadata:
		794 |       BuildMethod: esbuild
		795 |       BuildProperties:
		796 |         Minify: true
		797 |         Target: "es2020"
		798 |         SourceMap: false
		799 |         EntryPoints:
		800 |           - app.ts
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/auth/template.yaml.AWS::Serverless::Function.TestFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: AWS::Serverless::Function.TestFunction
File: /auth/template.yaml: 802-826
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		802 |   TestFunction:
		803 |     Type: AWS::Serverless::Function
		804 |     Properties:
		805 |       CodeUri: hello-world/
		806 |       Handler: app.lambdaHandler
		807 |       Events:
		808 |         HelloWorldApi:
		809 |           Type: Api
		810 |           Properties:
		811 |             RestApiId:
		812 |               Ref: ApiGateway
		813 |             Path: /test
		814 |             Method: GET
		815 |       Tags:
		816 |         Product: GOV.UK
		817 |         Environment: !Ref Environment
		818 |         System: Authentication
		819 |     Metadata:
		820 |       BuildMethod: esbuild
		821 |       BuildProperties:
		822 |         Minify: true
		823 |         Target: es2020
		824 |         SourceMap: false
		825 |         EntryPoints:
		826 |           - app.ts
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/auth/template.yaml.AWS::Serverless::Function.TestFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: AWS::Serverless::Function.TestFunction
File: /auth/template.yaml: 802-826
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		802 |   TestFunction:
		803 |     Type: AWS::Serverless::Function
		804 |     Properties:
		805 |       CodeUri: hello-world/
		806 |       Handler: app.lambdaHandler
		807 |       Events:
		808 |         HelloWorldApi:
		809 |           Type: Api
		810 |           Properties:
		811 |             RestApiId:
		812 |               Ref: ApiGateway
		813 |             Path: /test
		814 |             Method: GET
		815 |       Tags:
		816 |         Product: GOV.UK
		817 |         Environment: !Ref Environment
		818 |         System: Authentication
		819 |     Metadata:
		820 |       BuildMethod: esbuild
		821 |       BuildProperties:
		822 |         Minify: true
		823 |         Target: es2020
		824 |         SourceMap: false
		825 |         EntryPoints:
		826 |           - app.ts
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/auth/template.yaml.AWS::Serverless::Function.TestFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: AWS::Serverless::Function.TestFunction
File: /auth/template.yaml: 802-826
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		802 |   TestFunction:
		803 |     Type: AWS::Serverless::Function
		804 |     Properties:
		805 |       CodeUri: hello-world/
		806 |       Handler: app.lambdaHandler
		807 |       Events:
		808 |         HelloWorldApi:
		809 |           Type: Api
		810 |           Properties:
		811 |             RestApiId:
		812 |               Ref: ApiGateway
		813 |             Path: /test
		814 |             Method: GET
		815 |       Tags:
		816 |         Product: GOV.UK
		817 |         Environment: !Ref Environment
		818 |         System: Authentication
		819 |     Metadata:
		820 |       BuildMethod: esbuild
		821 |       BuildProperties:
		822 |         Minify: true
		823 |         Target: es2020
		824 |         SourceMap: false
		825 |         EntryPoints:
		826 |           - app.ts
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/auth/template.yaml.AWS::Serverless::Function.AuthProxyFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: AWS::Serverless::Function.AuthProxyFunction
File: /auth/template.yaml: 894-949
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/auth/template.yaml.AWS::Serverless::Function.AuthProxyFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: AWS::Serverless::Function.AuthProxyFunction
File: /auth/template.yaml: 894-949
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environment variable" classname="/auth/template.yaml.AWS::Serverless::Function.AuthProxyFunction" file="/auth/template.yaml">
			<failure type="failure" message="Check encryption settings for Lambda environment variable">
Resource: AWS::Serverless::Function.AuthProxyFunction
File: /auth/template.yaml: 894-949
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/auth/template.yaml.AWS::Serverless::Function.AuthProxyFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: AWS::Serverless::Function.AuthProxyFunction
File: /auth/template.yaml: 894-949
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_95] Ensure API Gateway V2 has Access Logging enabled" classname="/auth/template.yaml.AWS::ApiGatewayV2::Stage.AuthProxyStage" file="/auth/template.yaml">
			<failure type="failure" message="Ensure API Gateway V2 has Access Logging enabled">
Resource: AWS::ApiGatewayV2::Stage.AuthProxyStage
File: /auth/template.yaml: 967-972
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-30

		967 |   AuthProxyStage:
		968 |     Type: AWS::ApiGatewayV2::Stage
		969 |     Properties:
		970 |       ApiId: !Ref AuthProxyApi
		971 |       StageName: !Ref Environment
		972 |       AutoDeploy: true
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_120] Ensure API Gateway caching is enabled" classname="/auth/template.yaml.AWS::Serverless::Api.SharedSignalsApi" file="/auth/template.yaml">
			<failure type="failure" message="Ensure API Gateway caching is enabled">
Resource: AWS::Serverless::Api.SharedSignalsApi
File: /auth/template.yaml: 1023-1043
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-api-gateway-caching-is-enabled

		1023 |   SharedSignalsApi:
		1024 |     Type: AWS::Serverless::Api
		1025 |     Properties:
		1026 |       Name: !Join
		1027 |         - "-"
		1028 |         - - !Ref AWS::StackName
		1029 |           - "shared-signals"
		1030 |           - Fn::Select:
		1031 |               - 4
		1032 |               - Fn::Split:
		1033 |                   - "-"
		1034 |                   - Fn::Select:
		1035 |                       - 2
		1036 |                       - Fn::Split:
		1037 |                           - "/"
		1038 |                           - Ref: AWS::StackId
		1039 |       StageName: !Ref Environment
		1040 |       Tags:
		1041 |         Product: GOV.UK
		1042 |         Environment: !Ref Environment
		1043 |         System: Authentication
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_73] Ensure API Gateway has X-Ray Tracing enabled" classname="/auth/template.yaml.AWS::Serverless::Api.SharedSignalsApi" file="/auth/template.yaml">
			<failure type="failure" message="Ensure API Gateway has X-Ray Tracing enabled">
Resource: AWS::Serverless::Api.SharedSignalsApi
File: /auth/template.yaml: 1023-1043
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-15

		1023 |   SharedSignalsApi:
		1024 |     Type: AWS::Serverless::Api
		1025 |     Properties:
		1026 |       Name: !Join
		1027 |         - "-"
		1028 |         - - !Ref AWS::StackName
		1029 |           - "shared-signals"
		1030 |           - Fn::Select:
		1031 |               - 4
		1032 |               - Fn::Split:
		1033 |                   - "-"
		1034 |                   - Fn::Select:
		1035 |                       - 2
		1036 |                       - Fn::Split:
		1037 |                           - "/"
		1038 |                           - Ref: AWS::StackId
		1039 |       StageName: !Ref Environment
		1040 |       Tags:
		1041 |         Product: GOV.UK
		1042 |         Environment: !Ref Environment
		1043 |         System: Authentication
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_76] Ensure API Gateway has Access Logging enabled" classname="/auth/template.yaml.AWS::Serverless::Api.SharedSignalsApi" file="/auth/template.yaml">
			<failure type="failure" message="Ensure API Gateway has Access Logging enabled">
Resource: AWS::Serverless::Api.SharedSignalsApi
File: /auth/template.yaml: 1023-1043
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-17

		1023 |   SharedSignalsApi:
		1024 |     Type: AWS::Serverless::Api
		1025 |     Properties:
		1026 |       Name: !Join
		1027 |         - "-"
		1028 |         - - !Ref AWS::StackName
		1029 |           - "shared-signals"
		1030 |           - Fn::Select:
		1031 |               - 4
		1032 |               - Fn::Split:
		1033 |                   - "-"
		1034 |                   - Fn::Select:
		1035 |                       - 2
		1036 |                       - Fn::Split:
		1037 |                           - "/"
		1038 |                           - Ref: AWS::StackId
		1039 |       StageName: !Ref Environment
		1040 |       Tags:
		1041 |         Product: GOV.UK
		1042 |         Environment: !Ref Environment
		1043 |         System: Authentication
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="/auth/template.yaml.AWS::Serverless::Function.SignalsFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured inside a VPC">
Resource: AWS::Serverless::Function.SignalsFunction
File: /auth/template.yaml: 1045-1083
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1

		1045 |   SignalsFunction:
		1046 |     Type: AWS::Serverless::Function
		1047 |     Properties:
		1048 |       FunctionName: !Join
		1049 |         - "-"
		1050 |         - - !Ref AWS::StackName
		1051 |           - "shared-signals-receiver"
		1052 |           - Fn::Select:
		1053 |               - 4
		1054 |               - Fn::Split:
		1055 |                   - "-"
		1056 |                   - Fn::Select:
		1057 |                       - 2
		1058 |                       - Fn::Split:
		1059 |                           - "/"
		1060 |                           - Ref: AWS::StackId
		1061 |       Description: "Shared Signals receiver function"
		1062 |       CodeUri: shared-signals/
		1063 |       Handler: app.lambdaHandler
		1064 |       Events:
		1065 |         HelloWorldApi:
		1066 |           Type: Api
		1067 |           Properties:
		1068 |             RestApiId:
		1069 |               Ref: SharedSignalsApi
		1070 |             Path: /receiver
		1071 |             Method: POST
		1072 |       Tags:
		1073 |         Product: GOV.UK
		1074 |         Environment: !Ref Environment
		1075 |         System: Authentication
		1076 |     Metadata:
		1077 |       BuildMethod: esbuild
		1078 |       BuildProperties:
		1079 |         Minify: true
		1080 |         Target: es2020
		1081 |         SourceMap: false
		1082 |         EntryPoints:
		1083 |           - app.ts
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="/auth/template.yaml.AWS::Serverless::Function.SignalsFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: AWS::Serverless::Function.SignalsFunction
File: /auth/template.yaml: 1045-1083
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		1045 |   SignalsFunction:
		1046 |     Type: AWS::Serverless::Function
		1047 |     Properties:
		1048 |       FunctionName: !Join
		1049 |         - "-"
		1050 |         - - !Ref AWS::StackName
		1051 |           - "shared-signals-receiver"
		1052 |           - Fn::Select:
		1053 |               - 4
		1054 |               - Fn::Split:
		1055 |                   - "-"
		1056 |                   - Fn::Select:
		1057 |                       - 2
		1058 |                       - Fn::Split:
		1059 |                           - "/"
		1060 |                           - Ref: AWS::StackId
		1061 |       Description: "Shared Signals receiver function"
		1062 |       CodeUri: shared-signals/
		1063 |       Handler: app.lambdaHandler
		1064 |       Events:
		1065 |         HelloWorldApi:
		1066 |           Type: Api
		1067 |           Properties:
		1068 |             RestApiId:
		1069 |               Ref: SharedSignalsApi
		1070 |             Path: /receiver
		1071 |             Method: POST
		1072 |       Tags:
		1073 |         Product: GOV.UK
		1074 |         Environment: !Ref Environment
		1075 |         System: Authentication
		1076 |     Metadata:
		1077 |       BuildMethod: esbuild
		1078 |       BuildProperties:
		1079 |         Minify: true
		1080 |         Target: es2020
		1081 |         SourceMap: false
		1082 |         EntryPoints:
		1083 |           - app.ts
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="/auth/template.yaml.AWS::Serverless::Function.SignalsFunction" file="/auth/template.yaml">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: AWS::Serverless::Function.SignalsFunction
File: /auth/template.yaml: 1045-1083
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		1045 |   SignalsFunction:
		1046 |     Type: AWS::Serverless::Function
		1047 |     Properties:
		1048 |       FunctionName: !Join
		1049 |         - "-"
		1050 |         - - !Ref AWS::StackName
		1051 |           - "shared-signals-receiver"
		1052 |           - Fn::Select:
		1053 |               - 4
		1054 |               - Fn::Split:
		1055 |                   - "-"
		1056 |                   - Fn::Select:
		1057 |                       - 2
		1058 |                       - Fn::Split:
		1059 |                           - "/"
		1060 |                           - Ref: AWS::StackId
		1061 |       Description: "Shared Signals receiver function"
		1062 |       CodeUri: shared-signals/
		1063 |       Handler: app.lambdaHandler
		1064 |       Events:
		1065 |         HelloWorldApi:
		1066 |           Type: Api
		1067 |           Properties:
		1068 |             RestApiId:
		1069 |               Ref: SharedSignalsApi
		1070 |             Path: /receiver
		1071 |             Method: POST
		1072 |       Tags:
		1073 |         Product: GOV.UK
		1074 |         Environment: !Ref Environment
		1075 |         System: Authentication
		1076 |     Metadata:
		1077 |       BuildMethod: esbuild
		1078 |       BuildProperties:
		1079 |         Minify: true
		1080 |         Target: es2020
		1081 |         SourceMap: false
		1082 |         EntryPoints:
		1083 |           - app.ts
</failure>
		</testcase>
	</testsuite>
</testsuites>
